Imports Microsoft.VisualBasic
Imports Microsoft.VisualBasic.CompilerServices
Imports System
Imports System.Collections.Generic
Imports System.ComponentModel
Imports System.Diagnostics
Imports System.Drawing
Imports System.IO
Imports System.Runtime.CompilerServices
Imports System.Text
Imports System.Threading
Imports System.Windows.Forms

Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load





    End Sub


    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        OpenFileDialog1.ShowDialog()
        OpenFileDialog1.Title = "apgjkapdgoikjadgpiadgjiodgjkadpgoiajgiao[jkfk"
        Button2.Enabled = True
        Button1.Enabled = False
        TextBox1.Text = Path.GetDirectoryName(Me.OpenFileDialog1.FileName)
        TextBox2.Text = Path.GetFileName(Me.OpenFileDialog1.FileName)
        TextBox3.Text = (TextBox1.Text & "\" & Me.TextBox2.Text)

    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click

        If Me.IsProcessOpen("Pharaoh_Redist_Installer") Then
            MessageBox.Show("Please wait until 'Pharaoh_Redist_Installer.exe' is done installing! " & ChrW(10) & " DONT CLOSE THE LAUNCHER!", "Installing C++ Redist.")
        Else
            Process.Start((Me.TextBox1.Text & "\HGWC.exe"), "56ECE78552EE8DD7D1AAE47807E1B319343E69BC272A9119E61710225563857DA5403FA7FF40449E881B5F25950DD31252F99930C383D39526FAD97C1C093539746EB7CF22185F8294A7BCD5D224EA0D1175E8FE7F8C094EE4290C841FC2C658AC7A6DFC6C64608B2A1130C4DBCE9E13D538DBDC57D9172CF11929CA33057B3ABF625BF666BF01EB1B7F59EDC690537B")
            Me.Label2.Text = " Starting game, please wait... \ يتم تشغيل اللعب، برجاء الانتظار..."
            Me.Button2.Enabled = False
            Me.WindowState = FormWindowState.Minimized
            Me.ShowInTaskbar = False
            Process.Start((Me.TextBox1.Text & "\Worker.exe"), "T1T4NR4N!@")
        End If



        Dim num1 As Integer
        Dim flag As Boolean = False
        If Me.IsProcessOpen("HGWC") Then
            flag = True
        End If
        If (Me.IsProcessOpen("HGWC") OrElse Not flag) Then
            num1 = 0
        Else
            num1 = 1
        End If
        If (num1 <> 0) Then
            Process.GetCurrentProcess.Kill()
        End If
        If Not Me.IsProcessOpen("Worker") Then
            Process.GetCurrentProcess.Kill()
        End If
        If Not Me.IsProcessOpen("x") Then
            Process.Start("x.exe")
        End If
        Thread.Sleep(60)
    End Sub

    Private Function IsProcessOpen(ByVal p1 As String) As Boolean

    End Function

    Private Sub Process1_Exited(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Process1.Exited

    End Sub

    Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick

    End Sub

    
End Class
